<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_45) on Thu Feb 27 23:05:27 CET 2014 -->
<title>org.jppf.management.forwarding (JPPF)</title>
<meta name="date" content="2014-02-27">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="org.jppf.management.forwarding (JPPF)";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li class="navBarCell1Rev">Package</li>
<li>Class</li>
<li><a href="package-use.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage"><em>
				
					<table>
					<tr>
						<td valign=center>
							<a href=http://www.jppf.org target=_top>
								<img src=http://www.jppf.org/images/jppf_group_large.gif border=0/>
							</a>
						</td>
					</tr>
					</table>
				
			</em></div>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../org/jppf/management/diagnostics/package-summary.html">Prev Package</a></li>
<li><a href="../../../../org/jppf/management/spi/package-summary.html">Next Package</a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?org/jppf/management/forwarding/package-summary.html" target="_top">Frames</a></li>
<li><a href="package-summary.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<div class="header">
<h1 title="Package" class="title">Package&nbsp;org.jppf.management.forwarding</h1>
<div class="docSummary">
<div class="block">Support for forwarding JMX requests to the nodes, along with receiving notifications from them,
 via the JPPF driver's JMX server.</div>
</div>
<p>See:&nbsp;<a href="#package_description">Description</a></p>
</div>
<div class="contentContainer">
<ul class="blockList">
<li class="blockList">
<table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Interface Summary table, listing interfaces, and an explanation">
<caption><span>Interface Summary</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Interface</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="../../../../org/jppf/management/forwarding/JPPFNodeForwardingMBean.html" title="interface in org.jppf.management.forwarding">JPPFNodeForwardingMBean</a></td>
<td class="colLast">
<div class="block">MBean interface for forwarding node management requests and monitoring notfications via the driver.</div>
</td>
</tr>
</tbody>
</table>
</li>
<li class="blockList">
<table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Class Summary table, listing classes, and an explanation">
<caption><span>Class Summary</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Class</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="../../../../org/jppf/management/forwarding/JPPFNodeForwardingNotification.html" title="class in org.jppf.management.forwarding">JPPFNodeForwardingNotification</a></td>
<td class="colLast">
<div class="block">Instances of this notification class wrap any JMX notification received from a node.</div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
<a name="package_description">
<!--   -->
</a>
<h2 title="Package org.jppf.management.forwarding Description">Package org.jppf.management.forwarding Description</h2>
<div class="block">Support for forwarding JMX requests to the nodes, along with receiving notifications from them,
 via the JPPF driver's JMX server. Which nodes are impacted is determined by a user-provided <a href="../../../../org/jppf/management/NodeSelector.html" title="interface in org.jppf.management"><code>node selector</code></a>.
 <p>This provides two major benefits:
 <ul>
 <li>this allows managing and monitoring the nodes in situations where the nodes are not reachable from the client,
 for instance when the client and nodes are on different networks or subnets</li>
 <li>the requests and notification forwarding mechanism automatically adapts to node connection and disconnection events,
 which means that if new nodes are started in the grid, they will be automatically enrolled in the forwarding mechanism, provided they match the node selector</li>
 </ul>
 
 <h2>Forwarding management requests</h2>
 <p>The request forwarding mechanism is based on a built-in driver MBean: <a href="../../../../org/jppf/management/forwarding/JPPFNodeForwardingMBean.html" title="interface in org.jppf.management.forwarding"><code>JPPFNodeForwardingMBean</code></a>, which provides methods to invoke methods, or get or set attributes on remote node MBeans.
 Each of its methods requires a <a href="../../../../org/jppf/management/NodeSelector.html" title="interface in org.jppf.management"><code>NodeSelector</code></a> argument and an MBean name, to determine to which nodes, and which MBean in these nodes, the request will be performed.
 The return value is always a map of node UUIDs to the corresponding value returned by the request (if any) to the corresponding node.
 If an exception is raised when performing the request on a specific node, then that exception is returned in the map.
 
 Here is an example:
 <pre>
 JPPFClient client = ...;
 AbstractJPPFClientConnection conn = (AbstractJPPFClientConnection) client.getClientConnection();
 JMXDriverConnectionWrapper driverJmx = conn.getJmxConnection();
 
 JPPFNodeForwardingMBean proxy =
   driverJmx.getProxy(JPPFNodeForwardingMBean.MBEAN_NAME, JPPFNodeForwardingMBean.class);
 
 // this selector selects all nodes attached to the driver
 NodeSelector selector = new NodeSelector.AllNodes();
 // this selector selects all nodes that have more than 2 processors
 ExecutionPolicy policy = new MoreThan("availableProcessors ", 2);
 NodeSelector selector2 = new NodeSelector.ExecutionPolicySelector(policy);
 
 // invoke the state() method on the remote 'JPPFNodeAdminMBean' node MBeans.
 // note that the MBean name does not need to be stated explicitely.
 Map&lt;String, Object&gt; results = proxy.state(selector);
 // this is an exact equivalent, explicitely stating the target MBean on the remote nodes:
 String targetMBeanName = JPPFNodeAdminMBean.MBEAN_NAME;
 Map&lt;String, Object&gt; results2 = proxy.forwardInvoke(selector, targetMBeanName, "state");
 
 // handling the results
 for (Map.Entry&lt;String, Object&gt; entry: results) {
   if (entry.getValue() instanceof Exception) {
     // handle the exception ...
   } else {
     JPPFNodeState state = (JPPFNodeState) entry.getValue();
     // handle the result ...
   }
 }
 </pre>
 
 <h2>Forwarding JMX notifications</h2>
 <p>JPPF provides a way to subscribe to notifications from a set of selected nodes, which differs from the one specified in the JMX API.
 This is due to the fact that the server-side mechanism for the registration of notification listeners is unspecified and thus provides
 no reliable way of overriding it.
 <p>To circumvent this, the notification listener registration is performed via the JMX client wrapper <a href="../../../../org/jppf/management/JMXDriverConnectionWrapper.html" title="class in org.jppf.management"><code>JMXDriverConnectionWrapper</code></a>:
 <ul>
 <li>to add a notification listener, use <a href="../../../../org/jppf/management/JMXDriverConnectionWrapper.html#registerForwardingNotificationListener(org.jppf.management.NodeSelector, java.lang.String, javax.management.NotificationListener, javax.management.NotificationFilter, java.lang.Object)"><code>registerForwardingNotificationListener(NodeSelector selector, String mBeanName, NotificationListener listener, NotificationFilter filter, Object handback)</code></a>.
 This will register a notification listener for the specified MBean on each of the selected nodes.
 This method returns a <i>listener ID</i> which will be used to remove the notfication listener later on.
 Thus, the application must be careful to keep track of all registered listener IDs.
 </li>
 <li>to remove a notification listener, use <a href="../../../../org/jppf/management/JMXDriverConnectionWrapper.html#unregisterForwardingNotificationListener(java.lang.String)"><code>unregisterForwardingNotificationListener(String listenerID)</code></a>.</li>
 </ul>
 <p>The notifications forwarded from the nodes are all wrapped into instances of <a href="../../../../org/jppf/management/forwarding/JPPFNodeForwardingNotification.html" title="class in org.jppf.management.forwarding"><code>JPPFNodeForwardingNotification</code></a>.
 This class, which inherits from <a href="http://docs.oracle.com/javase/7/docs/api/javax/management/Notification.html?is-external=true" title="class or interface in javax.management"><code>Notification</code></a>, provides additional APIs to identify from which node and which MBean the notification was emitted.
 <p>The following code sample puts it all together:
 <pre>
 JPPFClient client = ...;
 AbstractJPPFClientConnection conn = (AbstractJPPFClientConnection) client.getClientConnection();
 JMXDriverConnectionWrapper driverJmx = conn.getJmxConnection();
 // this selector selects all nodes attached to the driver
 NodeSelector selector = new NodeSelector.AllNodes();
 
 // create a JMX notification listener
 NotificationListener myListener = new NotificationListener() {
   &#64;Override
   public void handleNotification(Notification notification, Object handback) {
     JPPFNodeForwardingNotification notif = (JPPFNodeForwardingNotification) notification;
     System.out.println("received notification from nodeUuid=" + notif.getNodeUuid()
       + ", mBeanName=" + notif.getMBeanName());
     // get the actual notification sent by the node
     TaskExecutionNotification actualNotif = (TaskExecutionNotification) notif.getNotification();
     // handle the notification data ...
   }
 }
 
 // register the notification listener with the JPPFNodeTaskMonitorMBean on the selected nodes
 String listenerID = driverJmx.registerForwardingNotificationListener(
   selector, JPPFNodeTaskMonitorMBean.MBEAN_NAME, listener, null, null);
 
 // ... submit a JPPF job ...
 
 // once the job has completed, unregister the notification listener
 driverJmx.unregisterForwardingNotificationListener(listenerID);
 </pre></div>
</div>
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li class="navBarCell1Rev">Package</li>
<li>Class</li>
<li><a href="package-use.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage"><em>
				
					<table>
					<tr>
						<td valign=center>
							<a href=http://www.jppf.org target=_top>
								<img src=http://www.jppf.org/images/jppf_group_large.gif border=0/>
							</a>
						</td>
					</tr>
					</table>
				
			</em></div>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../org/jppf/management/diagnostics/package-summary.html">Prev Package</a></li>
<li><a href="../../../../org/jppf/management/spi/package-summary.html">Next Package</a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?org/jppf/management/forwarding/package-summary.html" target="_top">Frames</a></li>
<li><a href="package-summary.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>
				
					<font face=Arial size=2 color=#808080><i>Copyright &copy; 2005-2013 JPPF Team.</i></font>
				
			</small></p>
</body>
</html>
